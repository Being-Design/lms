var usinCustomFieldsApp=angular.module("usinCustomFieldsApp",["usinNgHelpers"],["$httpProvider",function(a){a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=utf-8",a.defaults.transformRequest=[function(a){return angular.isObject(a)&&"[object File]"!==String(a)?usinHelpers.serializeObject(a):a}]}]).value("options",{}).run(["options",function(a){var b=window.USIN;for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])}]);usinCustomFieldsApp.controller("UsinMainCtrl",["$scope","options","UsinCustomFieldsQuery",function(a,b,c){a.strings=b.strings,a.fieldTypes=b.fieldTypes,a.fields=b.fields,a.errorMsg="",a.loading=!1,a.customTemplates=b.customTemplates;var d=function(){a.field={name:"",key:"",type:"text"}};d(),a.addField=function(){a.loading||(a.loading=!0,a.errorMsg="",c.addField(a.field).then(function(c){a.loading=!1;var e=c.data;e.success&&e.fields?(a.fields=e.fields,d()):a.errorMsg=e.error||b.strings.fieldUpdateError},function(){a.loading=!1,a.errorMsg=b.strings.fieldUpdateError}))},a.$on("fieldsChange",function(b,c){a.fields=c})}]).controller("UsinSingleFieldCtrl",["$scope","options","UsinCustomFieldsQuery",function(a,b,c){a.loading=!1,a.errorMsg="",a.editing=!1,a.getTypeName=function(b){for(var c in a.fieldTypes)if(a.fieldTypes[c].type==b)return a.fieldTypes[c].name;return b},a.deleteField=function(){a.loading||(a.loading=!0,a.errorMsg="",c.deleteField(a.f.key).then(function(c){a.loading=!1;var d=c.data;d.success&&d.fields?a.$emit("fieldsChange",d.fields):a.errorMsg=d.error||b.strings.fieldUpdateError},function(){a.errorMsg=data.error||b.strings.fieldUpdateError}))},a.toggleEdit=function(){a.editing=!a.editing},a.updateField=function(){a.loading||(a.loading=!0,a.errorMsg="",c.updateField(a.f).then(function(c){a.loading=!1;var d=c.data;d.success&&d.fields?a.$emit("fieldsChange",d.fields):a.errorMsg=d.error||b.strings.fieldUpdateError},function(){a.errorMsg=data.error||b.strings.fieldUpdateError}))}}]),usinCustomFieldsApp.directive("usinMain",["options",function(a){return{restrict:"EAC",templateUrl:a.viewsURL+"/main.html",controller:"UsinMainCtrl"}}]),usinCustomFieldsApp.factory("UsinCustomFieldsQuery",["options","$http",function(a,b){return{addField:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_add_field"),e={nonce:a.nonce,field_name:c.name,field_key:c.key,field_type:c.type};return b({method:"post",url:d,data:e})},deleteField:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_delete_field"),e={nonce:a.nonce,field_key:c};return b({method:"post",url:d,data:e})},updateField:function(c){var d=usinHelpers.url.addParam(a.ajaxURL,"action","usin_update_field"),e={nonce:a.nonce,field_name:c.name,field_key:c.key,field_type:c.type};return b({method:"post",url:d,data:e})}}}]);
//# sourceMappingURL=custom-fields.min.js.map